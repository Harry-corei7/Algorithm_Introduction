`难度：中等`

- 给你一个字符串表达式`s`，请你实现一个基本计算器来计算并返回它的值。
- 整数除法仅保留整数部分。
- 你可以假设给定的表达式总是有效的。所有中间结果将在`[-231, 231 - 1]`的范围内。
- 注意：不允许使用任何将字符串作为数学表达式计算的内置函数，比如`eval()`。

- 示例 1：
  - 输入：s = "3+2*2"
  - 输出：7
- 示例 2：
  - 输入：s = " 3/2 "
  - 输出：1
- 示例 3：
  - 输入：s = " 3+5 / 2 "
  - 输出：5
---
`python`
```python
class Solution(object):
    def __init__(self):
        self.op_priority = {'+': 1, '-': 1, '*': 2, '/': 2, '^': 3}
        self.num_stack = []
        self.op_stack = []

    def calc(self):
        if(len(self.num_stack) < 2 or len(self.op_stack) == 0):
            return
        b = self.num_stack.pop(-1)
        a = self.num_stack.pop(-1)
        op = self.op_stack.pop(-1)
        if(op == '+'):
            res = a + b
        elif(op == '-'):
            res = a - b
        elif(op == '*'):
            res = a * b
        elif(op == '/'):
            res = int(a / b)
        elif(op == '^'):
            res = int(a ** b)
        self.num_stack.append(res)
        

    def calculate(self, s):
        """
        :type s: str
        :rtype: int
        """
        s = s.replace(" ", "")
        i = 0
        while(i < len(s)):
            if(s[i] == '('): # 左括号
                self.op_stack.append(s[i])
            elif(s[i] == ')'): # 右括号
                while(op_stack[-1] != '('):
                    self.calc
                op_stack.pop(-1)
            elif(s[i].isdigit()): # 数字
                num = 0
                while(i < len(s) and s[i].isdigit()): # 考虑多位数
                    num = num * 10 + int(s[i])
                    i += 1
                self.num_stack.append(num)
                continue
            else: # 运算符
                ch = s[i]
                if((ch == '-') and (i == 0 or s[i - 1] == '(')):
                    self.num_stack.append(0)
                
                while(self.op_stack and self.op_stack[-1] != '(' and 
                    self.op_priority[self.op_stack[-1]] >= self.op_priority[ch]):
                    self.calc()
                self.op_stack.append(ch)
            i += 1
        
        while(len(self.op_stack) != 0):
            self.calc()
        
        return self.num_stack[-1]
```
